<VirtualHost *:80>

    ServerName stuhlgang-dev.216software.com
    ServerAdmin webmaster@localhost

    # CHANGE THIS PATH
    DocumentRoot /home/stuhlgang/checkouts/stuhlgang/api/static

    # CHANGE THIS PATH
    # This section needs to be commented out on older versions of
    # apache, like below 2.4.
    <Directory /home/stuhlgang/checkouts/stuhlgang/api/static>
        Order allow,deny
        Allow from all
        Require all granted
    </Directory>

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel info

    CustomLog /var/log/apache2/stuhlgang-access.log combined
    ErrorLog /var/log/apache2/stuhlgang-error.log
    ServerSignature On

    ProxyRequests Off

    <Proxy *>
    Order deny,allow
    Allow from all
    </Proxy>

    RewriteEngine on

    # Make EVERYTHING https.  Uncomment this if you want.  But then
    # you'll need to set up a cert and add a new VirtualHost block for
    # port 443.
    # RewriteRule ^/(.*) https://stuhlgang.216software.com/$1 [L,R]

    # Tell apache to serve up static_files directly.

    # UPDATE THESE PATHS
    RewriteRule ^/favicon.ico   /home/stuhlgang/checkouts/stuhlgang/api/static/favicon.ico [last]
    RewriteRule ^/humans.txt    /home/stuhlgang/checkouts/stuhlgang/api/static/humans.txt [last]
    RewriteRule ^/robots.txt    /home/stuhlgang/checkouts/stuhlgang/api/static/robots.txt [last]
    RewriteRule ^/static/(.*)   /home/stuhlgang/checkouts/stuhlgang/api/static/$1 [last]

    # Tell apache to proxy everything else to the inner gunicorn app.
    RewriteRule ^/(.*)$ http://localhost:6666/$1 [proxy]


</VirtualHost>

<VirtualHost *:443>

    ServerName frippery.216software.com
    ServerAdmin webmaster@localhost
    ServerAlias stream.216software.com

    DocumentRoot /home/frippery/checkouts/frippery/pyfrippery/static

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel info

    CustomLog /var/log/apache2/frippery-access.log combined
    ErrorLog /var/log/apache2/frippery-error.log
    ServerSignature On

    <Directory /var/frippery >
        # AuthName "IE"
        # AuthUserFile /etc/apache2/sites-available/.htpasswd
        # AuthType Basic
        # Require valid-user
        Order allow,deny
        Allow from all
        Require all granted
        Options Indexes
    </Directory>

    <Directory /home/frippery/checkouts/frippery/pyfrippery/docs>
        Order allow,deny
        Allow from all
        Require all granted
        Options Indexes
    </Directory>

    <Directory /home/frippery/checkouts/frippery/pyfrippery/static>
        Order allow,deny
        Allow from all
        Require all granted
    </Directory>

    ProxyRequests Off

    <Proxy *>
    Order deny,allow
    Allow from all
    </Proxy>

    RewriteEngine on

    # Use apache to serve up static_files directly.
    RewriteRule ^/favicon.ico       /home/frippery/checkouts/frippery/pyfrippery/static/favicon.ico [last]
    RewriteRule ^/humans.txt        /home/frippery/checkouts/frippery/pyfrippery/static/humans.txt [last]
    RewriteRule ^/robots.txt        /home/frippery/checkouts/frippery/pyfrippery/static/robots.txt [last]
    RewriteRule ^/static/(.*)       /home/frippery/checkouts/frippery/pyfrippery/static/$1 [last]
    RewriteRule ^/raw_files/(.*) 	/var/frippery/unzipped/$1 [last]
    RewriteRule ^/csv/(.*) 		    /var/frippery/csv/$1 [last]
    RewriteRule ^/barcodes/(.*)     /var/frippery/barcodes/$1 [last]
    RewriteRule ^/docs/(.*)         /home/frippery/checkouts/frippery/pyfrippery/docs/$1 [last]

    # Tell apache to proxy everything else to the inner gunicorn app.
    RewriteRule ^/(.*)$ http://localhost:6161/$1 [proxy]

    SSLEngine on

    # Matt added this stuff
    SSLCertificateFile /etc/ssl/certs/2014.wildcard.216software.com.crt
    SSLCertificateKeyFile /etc/ssl/private/jan.216software.com.key
    SSLCertificateChainFile /etc/ssl/certs/RapidSSLCABundle.txt

</VirtualHost>
